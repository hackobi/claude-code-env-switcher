/**
 * DAHR Attestation Verification Utilities
 *
 * Provides cryptographic verification of Key Server attestations.
 * Allows consuming apps to independently verify that the Key Server
 * actually performed the OAuth verification.
 */
import type { DAHRAttestation, OAuthVerificationResult, WalletBinding } from "./types";
/**
 * Options for attestation verification
 */
export interface VerifyAttestationOptions {
    /**
     * Maximum age of attestation in milliseconds (default: 1 hour)
     * Set to 0 to disable timestamp validation
     */
    maxAge?: number;
    /**
     * Expected node public key (optional additional validation)
     */
    expectedNodePubKey?: string;
}
/**
 * Result of attestation verification
 */
export interface AttestationVerificationResult {
    /** Whether the attestation is valid */
    valid: boolean;
    /** Reason for failure (if invalid) */
    reason?: string;
    /** Attestation metadata for logging/auditing */
    metadata?: {
        sessionId: string;
        timestamp: number;
        keyServerPubKey: string;
        nodePubKey: string;
        version: string;
        /** Wallet binding if present in attestation */
        walletBinding?: WalletBinding;
    };
}
/**
 * Verify a DAHR attestation from Key Server
 *
 * This function verifies:
 * 1. The Ed25519 signature is valid for the responseHash
 * 2. The signature was made by the expected Key Server public key
 * 3. The attestation is not expired (optional)
 * 4. The node public key matches expected (optional)
 *
 * @param attestation - The DAHR attestation to verify
 * @param keyServerPubKey - Expected Key Server public key (hex-encoded)
 * @param options - Additional verification options
 * @returns Verification result with validity and reason
 *
 * @example
 * ```typescript
 * const result = await client.verifyOAuth("github", { ... });
 *
 * const verification = verifyAttestation(
 *     result.attestation,
 *     KNOWN_KEY_SERVER_PUBKEY,
 * );
 *
 * if (!verification.valid) {
 *     console.error("Attestation invalid:", verification.reason);
 * }
 * ```
 */
export declare function verifyAttestation(attestation: DAHRAttestation, keyServerPubKey: string, options?: VerifyAttestationOptions): AttestationVerificationResult;
/**
 * Verify attestation from a full OAuth verification result
 *
 * Convenience wrapper that extracts the attestation from the result.
 *
 * @param result - The OAuth verification result
 * @param keyServerPubKey - Expected Key Server public key (hex-encoded)
 * @param options - Additional verification options
 * @returns Verification result
 */
export declare function verifyOAuthAttestation(result: OAuthVerificationResult, keyServerPubKey: string, options?: VerifyAttestationOptions): AttestationVerificationResult;
