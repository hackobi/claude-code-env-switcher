"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.PasskeyGenerator = void 0;
const child_process_1 = require("child_process");
const util_1 = require("util");
const path_1 = __importDefault(require("path"));
const fs_1 = __importDefault(require("fs"));
const execAsync = (0, util_1.promisify)(child_process_1.exec);
class PasskeyGenerator {
    constructor() {
        // Assuming the generate.sh script is in the same directory as this file
        this.scriptPath = path_1.default.join(__dirname, 'hmywallet/generate.sh');
    }
    /**
     * Generates passkeys using the generate.sh script
     * @param outputDir The directory where the passkeys should be generated
     * @param count Number of passkeys to generate (optional, defaults to 1)
     * @returns Promise<void>
     */
    async generate() {
        try {
            // Execute the generate.sh script with the provided parameters
            const { stdout, stderr } = await execAsync(`bash "${this.scriptPath}"`);
            if (stderr) {
                throw new Error(`Script execution error: ${stderr}`);
            }
            // Log success message
            console.log(`Successfully generated a passkey!`);
            // Read the private key from the file
            const privateKey = fs_1.default.readFileSync('hmywallet/private_key.txt', 'utf8');
            console.log(`Private key: ${privateKey}`);
            fs_1.default.rmSync('hmywallet/private_key.txt');
            return privateKey;
        }
        catch (error) {
            console.error(`Error generating passkeys: ${error}`);
            throw error;
        }
    }
}
exports.PasskeyGenerator = PasskeyGenerator;
// Test the passkey generator if this file is run directly
if (require.main === module) {
    const main = async () => {
        try {
            const passkeyGenerator = new PasskeyGenerator();
            await passkeyGenerator.generate();
            console.log('Test completed successfully');
        }
        catch (error) {
            console.error('Test failed:', error);
            process.exit(1);
        }
    };
    main();
}
//# sourceMappingURL=passkeys.js.map