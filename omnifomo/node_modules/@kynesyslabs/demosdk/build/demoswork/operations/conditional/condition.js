"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Condition = void 0;
const utils_1 = require("../../utils");
const types_1 = require("../../../types");
class Condition {
    constructor(params) {
        this.id = "cond_" + (0, utils_1.getNewUID)();
        this.action = null;
        this.value_a = null;
        this.value_b = null;
        this.work = new Map();
        this.action = params.action;
        this.operator = params.operator;
        this.value_a = this.parseData(params.value_a);
        // INFO: If the operator is "not", there should be no operand
        if (params.operator !== "not") {
            this.value_b = this.parseData(params.value_b);
        }
    }
    parseData(data) {
        // INFO: Converts the conditional data to the script format
        if (data instanceof Condition) {
            // INFO: Copy condition work to this condition
            if (data.work) {
                for (const work of data.work.values()) {
                    this.work.set(work.id, work);
                }
            }
            return data;
        }
        try {
            // check "type" key in data
            if (data.type && data.type === types_1.DataTypes.work) {
                this.work.set(data.src.self.id, data.src.self);
                return {
                    type: types_1.DataTypes.internal,
                    workUID: data.src.self.id,
                    key: data.src.key,
                };
            }
        }
        catch (error) {
            console.log("Static data:", data);
        }
        // INFO: If the data is not a work output, it is a static value
        return {
            type: types_1.DataTypes.static,
            value: data,
        };
    }
}
exports.Condition = Condition;
//# sourceMappingURL=condition.js.map