"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Verifier = exports.Prover = void 0;
const big_integer_1 = __importDefault(require("big-integer"));
class Prover {
    constructor(prime1, prime2, secret) {
        this.modulus = prime1.multiply(prime2);
        this.secret = secret;
    }
    generateCommitment() {
        this.randomValue = big_integer_1.default.randBetween(2, this.modulus.subtract(2));
        return this.randomValue.modPow(2, this.modulus);
    }
    respondToChallenge(challenge) {
        return challenge === 0
            ? this.randomValue
            : this.randomValue.multiply(this.secret).mod(this.modulus);
    }
}
exports.Prover = Prover;
class Verifier {
    constructor(modulus) {
        this.modulus = modulus;
    }
    generateChallenge(commitment) {
        this.commitment = commitment;
        return Math.round(Math.random());
    }
    verifyResponse(response, challenge) {
        const responseSquared = response.modPow(2, this.modulus);
        if (challenge === 0) {
            return responseSquared.equals(this.commitment);
        }
        else {
            return !responseSquared.equals(this.commitment);
        }
    }
}
exports.Verifier = Verifier;
//# sourceMappingURL=index.js.map